"use strict";var _a,_b,_c,_d;Object.defineProperty(exports,"__esModule",{value:!0}),exports.HttpRouteIntegration=exports.HttpIntegration=exports.PayloadFormatVersion=exports.HttpConnectionType=exports.IntegrationCredentials=exports.HttpIntegrationSubtype=exports.HttpIntegrationType=void 0;var jsiiDeprecationWarnings=()=>{var tmp=require("../../../.warnings.jsii.js");return jsiiDeprecationWarnings=()=>tmp,tmp};const JSII_RTTI_SYMBOL_1=Symbol.for("jsii.rtti");var index_1=()=>{var tmp=require(".././index");return index_1=()=>tmp,tmp},core_1=()=>{var tmp=require("../../../core");return core_1=()=>tmp,tmp},HttpIntegrationType;(function(HttpIntegrationType2){HttpIntegrationType2.HTTP_PROXY="HTTP_PROXY",HttpIntegrationType2.AWS_PROXY="AWS_PROXY"})(HttpIntegrationType||(exports.HttpIntegrationType=HttpIntegrationType={}));var HttpIntegrationSubtype;(function(HttpIntegrationSubtype2){HttpIntegrationSubtype2.EVENTBRIDGE_PUT_EVENTS="EventBridge-PutEvents",HttpIntegrationSubtype2.SQS_SEND_MESSAGE="SQS-SendMessage",HttpIntegrationSubtype2.SQS_RECEIVE_MESSAGE="SQS-ReceiveMessage",HttpIntegrationSubtype2.SQS_DELETE_MESSAGE="SQS-DeleteMessage",HttpIntegrationSubtype2.SQS_PURGE_QUEUE="SQS-PurgeQueue",HttpIntegrationSubtype2.APPCONFIG_GET_CONFIGURATION="AppConfig-GetConfiguration",HttpIntegrationSubtype2.KINESIS_PUT_RECORD="Kinesis-PutRecord",HttpIntegrationSubtype2.STEPFUNCTIONS_START_EXECUTION="StepFunctions-StartExecution",HttpIntegrationSubtype2.STEPFUNCTIONS_START_SYNC_EXECUTION="StepFunctions-StartSyncExecution",HttpIntegrationSubtype2.STEPFUNCTIONS_STOP_EXECUTION="StepFunctions-StopExecution"})(HttpIntegrationSubtype||(exports.HttpIntegrationSubtype=HttpIntegrationSubtype={}));class IntegrationCredentials{static fromRole(role){try{jsiiDeprecationWarnings().aws_cdk_lib_aws_iam_IRole(role)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,this.fromRole),error}return{credentialsArn:role.roleArn}}static useCallerIdentity(){return{credentialsArn:`arn:${core_1().Aws.PARTITION}:iam::*:user/*`}}}exports.IntegrationCredentials=IntegrationCredentials,_a=JSII_RTTI_SYMBOL_1,IntegrationCredentials[_a]={fqn:"aws-cdk-lib.aws_apigatewayv2.IntegrationCredentials",version:"2.150.0"};var HttpConnectionType;(function(HttpConnectionType2){HttpConnectionType2.VPC_LINK="VPC_LINK",HttpConnectionType2.INTERNET="INTERNET"})(HttpConnectionType||(exports.HttpConnectionType=HttpConnectionType={}));class PayloadFormatVersion{static custom(version){return new PayloadFormatVersion(version)}constructor(version){this.version=version}}exports.PayloadFormatVersion=PayloadFormatVersion,_b=JSII_RTTI_SYMBOL_1,PayloadFormatVersion[_b]={fqn:"aws-cdk-lib.aws_apigatewayv2.PayloadFormatVersion",version:"2.150.0"},PayloadFormatVersion.VERSION_1_0=new PayloadFormatVersion("1.0"),PayloadFormatVersion.VERSION_2_0=new PayloadFormatVersion("2.0");class HttpIntegration extends core_1().Resource{constructor(scope,id,props){super(scope,id);try{jsiiDeprecationWarnings().aws_cdk_lib_aws_apigatewayv2_HttpIntegrationProps(props)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,HttpIntegration),error}if(!props.integrationSubtype&&!props.integrationUri)throw new Error("Either `integrationSubtype` or `integrationUri` must be specified.");if(props.timeout&&!props.timeout.isUnresolved()&&(props.timeout.toMilliseconds()<50||props.timeout.toMilliseconds()>29e3))throw new Error("Integration timeout must be between 50 milliseconds and 29 seconds.");const integ=new(index_1()).CfnIntegration(this,"Resource",{apiId:props.httpApi.apiId,integrationType:props.integrationType,integrationSubtype:props.integrationSubtype,integrationUri:props.integrationUri,integrationMethod:props.method,connectionId:props.connectionId,connectionType:props.connectionType,payloadFormatVersion:props.payloadFormatVersion?.version,requestParameters:props.parameterMapping?.mappings,credentialsArn:props.credentials?.credentialsArn,timeoutInMillis:props.timeout?.toMilliseconds()});props.secureServerName&&(integ.tlsConfig={serverNameToVerify:props.secureServerName}),this.integrationId=integ.ref,this.httpApi=props.httpApi}}exports.HttpIntegration=HttpIntegration,_c=JSII_RTTI_SYMBOL_1,HttpIntegration[_c]={fqn:"aws-cdk-lib.aws_apigatewayv2.HttpIntegration",version:"2.150.0"};class HttpRouteIntegration{constructor(id){this.id=id}_bindToRoute(options){if(this.integration&&this.integration.httpApi.node.addr!==options.route.httpApi.node.addr)throw new Error("A single integration cannot be associated with multiple APIs.");if(!this.integration){const config=this.bind(options);this.integration=new HttpIntegration(options.scope,this.id,{httpApi:options.route.httpApi,integrationType:config.type,integrationSubtype:config.subtype,integrationUri:config.uri,method:config.method,connectionId:config.connectionId,connectionType:config.connectionType,payloadFormatVersion:config.payloadFormatVersion,secureServerName:config.secureServerName,parameterMapping:config.parameterMapping,credentials:config.credentials,timeout:config.timeout})}return this.completeBind(options),{integrationId:this.integration.integrationId}}completeBind(_options){try{jsiiDeprecationWarnings().aws_cdk_lib_aws_apigatewayv2_HttpRouteIntegrationBindOptions(_options)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,this.completeBind),error}}}exports.HttpRouteIntegration=HttpRouteIntegration,_d=JSII_RTTI_SYMBOL_1,HttpRouteIntegration[_d]={fqn:"aws-cdk-lib.aws_apigatewayv2.HttpRouteIntegration",version:"2.150.0"};
