"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppSync=void 0;var jsiiDeprecationWarnings=()=>{var tmp=require("../../.warnings.jsii.js");return jsiiDeprecationWarnings=()=>tmp,tmp};const JSII_RTTI_SYMBOL_1=Symbol.for("jsii.rtti");var util_1=()=>{var tmp=require("./util");return util_1=()=>tmp,tmp},appsync=()=>{var tmp=require("../../aws-appsync");return appsync=()=>tmp,tmp};class AppSync{constructor(appsyncApi,props){this.appsyncApi=appsyncApi,this.props=props;try{jsiiDeprecationWarnings().aws_cdk_lib_aws_appsync_IGraphqlApi(appsyncApi),jsiiDeprecationWarnings().aws_cdk_lib_aws_events_targets_AppSyncGraphQLApiProps(props)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,AppSync),error}}bind(rule,_id){try{jsiiDeprecationWarnings().aws_cdk_lib_aws_events_IRule(rule)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,this.bind),error}if(this.props.deadLetterQueue&&(0,util_1().addToDeadLetterQueueResourcePolicy)(rule,this.props.deadLetterQueue),!this.appsyncApi.modes.includes(appsync().AuthorizationType.IAM))throw new Error("You must have AWS_IAM authorization mode enabled on your API to configure an AppSync target");if(this.appsyncApi.visibility!==appsync().Visibility.GLOBAL)throw new Error('Your API visibility must be "GLOBAL"');if(this.appsyncApi.graphQLEndpointArn==="")throw new Error("You must have a valid `graphQLEndpointArn` set");const role=this.props.eventRole||(0,util_1().singletonEventRole)(this.appsyncApi);return this.props.eventRole||this.appsyncApi.grantMutation(role),{...(0,util_1().bindBaseTargetConfig)(this.props),arn:this.appsyncApi.graphQLEndpointArn,role,deadLetterConfig:this.props.deadLetterQueue&&{arn:this.props.deadLetterQueue?.queueArn},input:this.props.variables,targetResource:this.appsyncApi,appSyncParameters:{graphQlOperation:this.props.graphQLOperation}}}}exports.AppSync=AppSync,_a=JSII_RTTI_SYMBOL_1,AppSync[_a]={fqn:"aws-cdk-lib.aws_events_targets.AppSync",version:"2.150.0"};
